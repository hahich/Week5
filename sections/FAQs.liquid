  {% assign section_color_scheme = section.settings.color_scheme | default: 'scheme-1' %}
  {% assign page_width = section.settings.section_width %}
  {% if page_width == blank or page_width == 'default' %}
    {% assign page_width = settings.page_width | default: 'default' %}
  {% endif %}

  {% comment %} Calculate section width based on settings {% endcomment %}
  {% assign calculated_width = '800px' %}
  {% if page_width == 'fluid' %}
    {% assign calculated_width = settings.page_width | default: '1200px' | append: 'px' %}
  {% elsif page_width == 'stretch' %}
    {% assign stretch_width = settings.page_width | default: '1200px' | append: 'px' %}
    {% assign calculated_width = stretch_width | minus: 40 | append: 'px' %}
  {% elsif page_width == 'full' %}
    {% assign calculated_width = '100vw' %}
  {% endif %}

  <div
    class="
      faqs-section
      section-width-{{ page_width }}
      header-size-{{ section.settings.header_size }}
      {% if section.settings.remove_default_space %}no-default-space{% endif %}
      color-{{ section_color_scheme }}
    "
    style="padding-top:{{ section.settings.padding_top }}px; padding-bottom:{{ section.settings.padding_bottom }}px; max-width: {{ calculated_width }}; margin: 0 auto;"
  >
    {% if section.settings.heading != blank %}
      <h2 style="font-weight: {{ section.settings.header_weight }}; font-size: {{ section.settings.header_size }}px; text-align: {{ section.settings.alignment }};">
        {{ section.settings.heading }}
      </h2>
    {% endif %}
    {% if section.settings.description != blank %}
      <div class="section-description" style="text-align: {{ section.settings.alignment }};">
        {{ section.settings.description }}
      </div>
    {% endif %}

    <div class="faqs-list">
      {% for block in section.blocks %}
        <div class="faq-item" {{ block.shopify_attributes }}>
          <button class="faq-question" aria-expanded="false">
            <span
              class="faq-question-text"
              ><strong>{{ block.settings.question }}</strong></span
            >
            <span class="faq-toggle">+</span>
          </button>
          <div class="faq-answer">
            {{ block.settings.answer }}
          </div>
        </div>
      {% endfor %}
    </div>
  </div>

  <style>
    .faqs-section {
      margin: 0 auto;
      color: rgb(var(--color-foreground));
      background: rgb(var(--color-background));
      padding: 0 3rem;
    }
    .section-width-default {
      max-width: 800px;
    }
    .section-width-stretch {
      padding: 0 20px;
    }
    .section-width-full {
      width: 100vw;
    }
    .align-left {
      text-align: left;
    }
    .align-center {
      text-align: center;
    }
    .align-right {
      text-align: right;
    }
    .header-size-small h2 {
      font-size: 1.5rem;
    }
    .header-size-medium h2 {
      font-size: 3rem;
    }
    .header-size-large h2 {
      font-size: 3.5rem;
    }
    .no-default-space {
      margin-top: 0 !important;
      margin-bottom: 0 !important;
    }
    .faq-item {
      border-bottom: 1px solid rgba(var(--color-foreground), 0.08);
      margin-bottom: 0;
      padding: 0;
    }
    .faq-question {
      width: 100%;
      background: none;
      border: none;
      outline: none;
      text-align: left;
      padding: 1.25rem 1rem;
      font-size: 1.6rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      transition: background 0.2s;
      color: rgb(var(--color-foreground));
    }
    .faq-question:hover {
      background: rgba(var(--color-foreground), 0.04);
    }
    .faq-toggle {
      font-size: 2rem;
      font-weight: 400;
      margin-left: 1rem;
      transition: transform 0.2s;
    }
    .faq-question[aria-expanded='true'] .faq-toggle {
      transform: rotate(180deg);
    }
    .faq-answer {
      margin: 0 0 1.25rem 0;
      padding-left: 1.5rem;
      color: rgb(var(--color-foreground));
      font-size: 1.5rem;
      line-height: 1.6;
      max-height: 0;
      opacity: 0;
      overflow: hidden;
      transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s;
    }
    .faq-answer.active {
      opacity: 1;
      max-height: 500px;
      transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s;
    }
  </style>

  <script src="{{ 'faq-accordion.js' | asset_url }}" defer></script>

  {% schema %}
  {
    "name": "t:sections.faqs.name",
    "settings": [
      {
        "type": "select",
        "id": "section_width",
        "label": "t:sections.faqs.settings.section_width.label",
        "options": [
          { "value": "default", "label": "t:sections.faqs.settings.section_width.options__1.label" },
          { "value": "fluid", "label": "t:sections.faqs.settings.section_width.options__2.label" },
          { "value": "stretch", "label": "t:sections.faqs.settings.section_width.options__3.label" },
          { "value": "full", "label": "t:sections.faqs.settings.section_width.options__4.label" }
        ],
        "default": "default"
      },
      {
        "type": "color_scheme",
        "id": "color_scheme",
        "label": "t:sections.all.colors.label",
        "default": "scheme-1"
      },
      {
        "type": "header",
        "content": "t:sections.faqs.settings.section_header.content"
      },
      {
        "type": "text",
        "id": "heading",
        "label": "t:sections.faqs.settings.heading.label",
        "default": "t:sections.faqs.settings.heading.default"
      },
      {
        "type": "richtext",
        "id": "description",
        "label": "t:sections.faqs.settings.description.label"
      },
      {
        "type": "select",
        "id": "header_size",
        "label": "t:sections.faqs.settings.header_size.label",
        "options": [
          { "value": "small", "label": "t:sections.faqs.settings.header_size.options__1.label" },
          { "value": "medium", "label": "t:sections.faqs.settings.header_size.options__2.label" },
          { "value": "large", "label": "t:sections.faqs.settings.header_size.options__3.label" }
        ],
        "default": "medium"
      },
      {
        "type": "select",
        "id": "header_weight",
        "label": "t:sections.faqs.settings.header_weight.label",
        "options": [
          { "value": "normal", "label": "t:sections.faqs.settings.header_weight.options__1.label" },
          { "value": "bold", "label": "t:sections.faqs.settings.header_weight.options__2.label" }
        ],
        "default": "normal"
      },
      {
        "type": "select",
        "id": "alignment",
        "label": "t:sections.faqs.settings.alignment.label",
        "options": [
          { "value": "left", "label": "t:sections.faqs.settings.alignment.options__1.label" },
          { "value": "center", "label": "t:sections.faqs.settings.alignment.options__2.label" },
          { "value": "right", "label": "t:sections.faqs.settings.alignment.options__3.label" }
        ],
        "default": "left"
      },
      {
        "type": "header",
        "content": "t:sections.faqs.settings.section_padding.content"
      },
      {
        "type": "range",
        "id": "padding_top",
        "label": "t:sections.faqs.settings.padding_top.label",
        "min": 0,
        "max": 100,
        "step": 4,
        "default": 32
      },
      {
        "type": "range",
        "id": "padding_bottom",
        "label": "t:sections.faqs.settings.padding_bottom.label",
        "min": 0,
        "max": 100,
        "step": 4,
        "default": 32
      },
      {
        "type": "checkbox",
        "id": "remove_default_space",
        "label": "t:sections.faqs.settings.remove_default_space.label",
        "default": false
      }
    ],
    "blocks": [
      {
        "type": "faq",
        "name": "t:sections.faqs.blocks.faq.name",
        "settings": [
          {
            "type": "text",
            "id": "question",
            "label": "t:sections.faqs.blocks.faq.settings.question.label"
          },
          {
            "type": "richtext",
            "id": "answer",
            "label": "t:sections.faqs.blocks.faq.settings.answer.label"
          }
        ]
      }
    ],
    "max_blocks": 20,
    "presets": [
      {
        "name": "t:sections.faqs.presets.name",
        "category": "Text",
        "settings": {
          "heading": "t:sections.faqs.presets.heading",
          "description": "t:sections.faqs.presets.description",
          "section_width": "default",
          "color_scheme": "scheme-1",
          "header_size": "medium",
          "header_weight": "bold",
          "alignment": "center",
          "padding_top": 32,
          "padding_bottom": 32
        },
        "blocks": [
          {
            "type": "faq",
            "settings": {
              "question": "t:sections.faqs.presets.items.question_1",
              "answer": "t:sections.faqs.presets.items.answer_1",
            }
          },
          {
            "type": "faq",
            "settings": {
              "question": "t:sections.faqs.presets.items.question_2",
              "answer": "t:sections.faqs.presets.items.answer_2",
            }
          },
          {
            "type": "faq",
            "settings": {
              "question": "t:sections.faqs.presets.items.question_3",
              "answer": "t:sections.faqs.presets.items.answer_3",
            }
          }
        ]
      }
    ]
  }
  {% endschema %}
